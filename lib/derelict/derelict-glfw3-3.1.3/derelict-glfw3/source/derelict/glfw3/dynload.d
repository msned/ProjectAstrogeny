/*

Boost Software License - Version 1.0 - August 17th,2003

Permission is hereby granted,free of charge,to any person or organization
obtaining a copy of the software and accompanying documentation covered by
this license (the "Software") to use,reproduce,display,distribute,
execute,and transmit the Software,and to prepare derivative works of the
Software,and to permit third-parties to whom the Software is furnished to
do so,all subject to the following:

The copyright notices in the Software and this entire statement,including
the above license grant,this restriction and the following disclaimer,
must be included in all copies of the Software,in whole or in part,and
all derivative works of the Software,unless such copies or derivative
works are solely in the form of machine-executable object code generated by
a source language processor.

THE SOFTWARE IS PROVIDED "AS IS",WITHOUT WARRANTY OF ANY KIND,EXPRESS OR
IMPLIED,INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE,TITLE AND NON-INFRINGEMENT. IN NO EVENT
SHALL THE COPYRIGHT HOLDERS OR ANYONE DISTRIBUTING THE SOFTWARE BE LIABLE
FOR ANY DAMAGES OR OTHER LIABILITY,WHETHER IN CONTRACT,TORT OR OTHERWISE,
ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.

*/
module derelict.glfw3.dynload;

version(DerelictGLFW3Static) {}
else { version = DerelictGLFW3Dynamic; }

version(DerelictGLFW3Dynamic):

public import derelict.glfw3.types;
import derelict.util.loader;
import derelict.util.system;

private {
    static if(Derelict_OS_Windows)
        enum libNames = "glfw3.dll";
    else static if(Derelict_OS_Mac)
        enum libNames = "libglfw.3.dylib,libglfw3.dylib";
    else static if(Derelict_OS_Posix)
        enum libNames = "libglfw3.so,libglfw.so.3,/usr/local/lib/libglfw3.so,/usr/local/lib/libglfw.so.3";
    else
        static assert(0,"Need to implement GLFW libNames for this operating system.");
}

extern(C) @nogc nothrow {
    alias da_glfwInit = int function();
    alias da_glfwTerminate = void function();
    alias da_glfwGetVersion = void function(int*,int*,int*);
    alias da_glfwGetVersionString = const(char)* function();

    alias da_glfwSetErrorCallback = GLFWerrorfun function(GLFWerrorfun);

    alias da_glfwGetMonitors = GLFWmonitor** function(int*);
    alias da_glfwGetPrimaryMonitor = GLFWmonitor* function();
    alias da_glfwGetMonitorPos = void function(GLFWmonitor*,int*,int*);
    alias da_glfwGetMonitorPhysicalSize = void function(GLFWmonitor*,int*,int*);
    alias da_glfwGetMonitorName = const(char)* function(GLFWmonitor*);
    alias da_glfwSetMonitorCallback = GLFWmonitorfun function(GLFWmonitorfun);

    alias da_glfwGetVideoModes = const(GLFWvidmode)* function(GLFWmonitor*,int*);
    alias da_glfwGetVideoMode = const(GLFWvidmode)* function(GLFWmonitor*);

    alias da_glfwSetGamma = void function(GLFWmonitor*,float);
    alias da_glfwGetGammaRamp = const(GLFWgammaramp*) function(GLFWmonitor*);
    alias da_glfwSetGammaRamp = void function(GLFWmonitor*,const(GLFWgammaramp)*);

    alias da_glfwDefaultWindowHints = void function();
    alias da_glfwWindowHint = void function(int,int);
    alias da_glfwCreateWindow = GLFWwindow* function(int,int,const(char)*,GLFWmonitor*,GLFWwindow*);
    alias da_glfwDestroyWindow = void function(GLFWwindow*);
    alias da_glfwWindowShouldClose = int function(GLFWwindow*);
    alias da_glfwSetWindowShouldClose = void function(GLFWwindow*,int);
    alias da_glfwSetWindowTitle = void function(GLFWwindow*,const(char)*);
    alias da_glfwSetWindowIcon = void function(GLFWwindow*,int,const(GLFWimage)*);
    alias da_glfwGetWindowPos = void function(GLFWwindow*,int*,int*);
    alias da_glfwSetWindowPos = void function(GLFWwindow*,int,int);
    alias da_glfwGetWindowSize = void function(GLFWwindow*,int*,int*);
    alias da_glfwSetWindowSizeLimits = void function(GLFWwindow*,int,int,int,int);
    alias da_glfwSetWindowAspectRatio = void function(GLFWwindow*,int,int);
    alias da_glfwSetWindowSize = void function(GLFWwindow*,int,int);
    alias da_glfwGetFramebufferSize = void function(GLFWwindow*,int*,int*);
    alias da_glfwGetWindowFrameSize = void function(GLFWwindow*,int*,int*,int*,int*);
    alias da_glfwIconifyWindow = void function(GLFWwindow*);
    alias da_glfwRestoreWindow = void function(GLFWwindow*);
    alias da_glfwMaximizeWindow = void function(GLFWwindow*);
    alias da_glfwShowWindow = void function(GLFWwindow*);
    alias da_glfwHideWindow = void function(GLFWwindow*);
    alias da_glfwFocusWindow = void function(GLFWwindow*);
    alias da_glfwGetWindowMonitor = GLFWmonitor* function(GLFWwindow*);
    alias da_glfwSetWindowMonitor = void function(GLFWwindow*,GLFWmonitor*,int,int,int,int,int);
    alias da_glfwGetWindowAttrib = int function(GLFWwindow*,int);
    alias da_glfwSetWindowUserPointer = void function(GLFWwindow*,void*);
    alias da_glfwGetWindowUserPointer = void* function(GLFWwindow*);
    alias da_glfwSetWindowPosCallback = GLFWwindowposfun function(GLFWwindow*,GLFWwindowposfun);
    alias da_glfwSetWindowSizeCallback = GLFWwindowsizefun function(GLFWwindow*,GLFWwindowsizefun);
    alias da_glfwSetWindowCloseCallback = GLFWwindowclosefun function(GLFWwindow*,GLFWwindowclosefun);
    alias da_glfwSetWindowRefreshCallback = GLFWwindowrefreshfun function(GLFWwindow*,GLFWwindowrefreshfun);
    alias da_glfwSetWindowFocusCallback = GLFWwindowfocusfun function(GLFWwindow*,GLFWwindowfocusfun);
    alias da_glfwSetWindowIconifyCallback = GLFWwindowiconifyfun function(GLFWwindow*,GLFWwindowiconifyfun);
    alias da_glfwSetFramebufferSizeCallback = GLFWframebuffersizefun function(GLFWwindow*,GLFWframebuffersizefun);

    alias da_glfwPollEvents = void function();
    alias da_glfwWaitEvents = void function();
    alias da_glfwWaitEventsTimeout = void function(double);
    alias da_glfwPostEmptyEvent = void function();

    alias da_glfwGetInputMode = int function(GLFWwindow*,int);
    alias da_glfwSetInputMode = void function(GLFWwindow*,int,int);
    alias da_glfwGetKeyName = const(char)* function(int,int);
    alias da_glfwGetKey = int function(GLFWwindow*,int);
    alias da_glfwGetMouseButton = int function(GLFWwindow*,int);
    alias da_glfwGetCursorPos = void function(GLFWwindow*,double*,double*);
    alias da_glfwSetCursorPos = void function(GLFWwindow*,double,double);
    alias da_glfwCreateCursor = GLFWcursor* function(const(GLFWimage)*,int,int);
    alias da_glfwCreateStandardCursor = GLFWcursor* function(int);
    alias da_glfwDestroyCursor = void function(GLFWcursor*);
    alias da_glfwSetCursor = void function(GLFWwindow*,GLFWcursor*);
    alias da_glfwSetKeyCallback = GLFWkeyfun function(GLFWwindow*,GLFWkeyfun);
    alias da_glfwSetCharCallback = GLFWcharfun function(GLFWwindow*,GLFWcharfun);
    alias da_glfwSetCharModsCallback = GLFWcharmodsfun function(GLFWwindow*,GLFWcharmodsfun);
    alias da_glfwSetMouseButtonCallback = GLFWmousebuttonfun function(GLFWwindow*,GLFWmousebuttonfun);
    alias da_glfwSetCursorPosCallback = GLFWcursorposfun function(GLFWwindow*,GLFWcursorposfun);
    alias da_glfwSetCursorEnterCallback = GLFWcursorenterfun function(GLFWwindow*,GLFWcursorenterfun);
    alias da_glfwSetScrollCallback = GLFWscrollfun function(GLFWwindow*,GLFWscrollfun);
    alias da_glfwSetDropCallback = GLFWdropfun function(GLFWwindow*,GLFWdropfun);

    alias da_glfwJoystickPresent = int function(int);
    alias da_glfwGetJoystickAxes = float* function(int,int*);
    alias da_glfwGetJoystickButtons = ubyte* function(int,int*);
    alias da_glfwGetJoystickName = const(char)* function(int);
    alias da_glfwSetJoystickCallback = GLFWjoystickfun function(GLFWjoystickfun);

    alias da_glfwSetClipboardString = void function(GLFWwindow*,const(char)*);
    alias da_glfwGetClipboardString = const(char)* function(GLFWwindow*);

    alias da_glfwGetTime = double function();
    alias da_glfwSetTime = void function(double);
    alias da_glfwGetTimerValue = long function();
    alias da_glfwGetTimerFrequency = long function();

    alias da_glfwMakeContextCurrent = void function(GLFWwindow*);
    alias da_glfwGetCurrentContext = GLFWwindow* function();
    alias da_glfwSwapBuffers = void function(GLFWwindow*);
    alias da_glfwSwapInterval = void function(int);
    alias da_glfwExtensionSupported = int function(const(char)*);
    alias da_glfwGetProcAddress = GLFWglproc function(const(char)*);
    alias da_glfwVulkanSupported = int function();
}

__gshared {
    da_glfwInit glfwInit;
    da_glfwTerminate glfwTerminate;
    da_glfwGetVersion glfwGetVersion;
    da_glfwGetVersionString glfwGetVersionString;
    da_glfwSetErrorCallback glfwSetErrorCallback;
    da_glfwGetMonitors glfwGetMonitors;
    da_glfwGetPrimaryMonitor glfwGetPrimaryMonitor;
    da_glfwGetMonitorPos glfwGetMonitorPos;
    da_glfwGetMonitorPhysicalSize glfwGetMonitorPhysicalSize;
    da_glfwGetMonitorName glfwGetMonitorName;
    da_glfwSetMonitorCallback glfwSetMonitorCallback;
    da_glfwGetVideoModes glfwGetVideoModes;
    da_glfwGetVideoMode glfwGetVideoMode;
    da_glfwSetGamma glfwSetGamma;
    da_glfwGetGammaRamp glfwGetGammaRamp;
    da_glfwSetGammaRamp glfwSetGammaRamp;
    da_glfwDefaultWindowHints glfwDefaultWindowHints;
    da_glfwWindowHint glfwWindowHint;
    da_glfwCreateWindow glfwCreateWindow;
    da_glfwDestroyWindow glfwDestroyWindow;
    da_glfwWindowShouldClose glfwWindowShouldClose;
    da_glfwSetWindowShouldClose glfwSetWindowShouldClose;
    da_glfwSetWindowTitle glfwSetWindowTitle;
    da_glfwSetWindowIcon glfwSetWindowIcon;
    da_glfwGetWindowPos glfwGetWindowPos;
    da_glfwSetWindowPos glfwSetWindowPos;
    da_glfwGetWindowSize glfwGetWindowSize;
    da_glfwSetWindowSizeLimits glfwSetWindowSizeLimits;
    da_glfwSetWindowAspectRatio glfwSetWindowAspectRatio;
    da_glfwSetWindowSize glfwSetWindowSize;
    da_glfwGetFramebufferSize glfwGetFramebufferSize;
    da_glfwGetWindowFrameSize glfwGetWindowFrameSize;
    da_glfwIconifyWindow glfwIconifyWindow;
    da_glfwRestoreWindow glfwRestoreWindow;
    da_glfwMaximizeWindow glfwMaximizeWindow;
    da_glfwShowWindow glfwShowWindow;
    da_glfwHideWindow glfwHideWindow;
    da_glfwFocusWindow glfwFocusWindow;
    da_glfwGetWindowMonitor glfwGetWindowMonitor;
    da_glfwSetWindowMonitor glfwSetWindowMonitor;
    da_glfwGetWindowAttrib glfwGetWindowAttrib;
    da_glfwSetWindowUserPointer glfwSetWindowUserPointer;
    da_glfwGetWindowUserPointer glfwGetWindowUserPointer;
    da_glfwSetWindowPosCallback glfwSetWindowPosCallback;
    da_glfwSetWindowSizeCallback glfwSetWindowSizeCallback;
    da_glfwSetWindowCloseCallback glfwSetWindowCloseCallback;
    da_glfwSetWindowRefreshCallback glfwSetWindowRefreshCallback;
    da_glfwSetWindowFocusCallback glfwSetWindowFocusCallback;
    da_glfwSetWindowIconifyCallback glfwSetWindowIconifyCallback;
    da_glfwSetFramebufferSizeCallback glfwSetFramebufferSizeCallback;
    da_glfwPollEvents glfwPollEvents;
    da_glfwWaitEvents glfwWaitEvents;
    da_glfwWaitEventsTimeout glfwWaitEventsTimeout;
    da_glfwPostEmptyEvent glfwPostEmptyEvent;
    da_glfwGetInputMode glfwGetInputMode;
    da_glfwSetInputMode glfwSetInputMode;
    da_glfwGetKeyName glfwGetKeyName;
    da_glfwGetKey glfwGetKey;
    da_glfwGetMouseButton glfwGetMouseButton;
    da_glfwGetCursorPos glfwGetCursorPos;
    da_glfwSetCursorPos glfwSetCursorPos;
    da_glfwCreateCursor glfwCreateCursor;
    da_glfwCreateStandardCursor glfwCreateStandardCursor;
    da_glfwDestroyCursor glfwDestroyCursor;
    da_glfwSetCursor glfwSetCursor;
    da_glfwSetKeyCallback glfwSetKeyCallback;
    da_glfwSetCharCallback glfwSetCharCallback;
    da_glfwSetCharModsCallback glfwSetCharModsCallback;
    da_glfwSetMouseButtonCallback glfwSetMouseButtonCallback;
    da_glfwSetCursorPosCallback glfwSetCursorPosCallback;
    da_glfwSetCursorEnterCallback glfwSetCursorEnterCallback;
    da_glfwSetScrollCallback glfwSetScrollCallback;
    da_glfwSetDropCallback glfwSetDropCallback;
    da_glfwJoystickPresent glfwJoystickPresent;
    da_glfwGetJoystickAxes glfwGetJoystickAxes;
    da_glfwGetJoystickButtons glfwGetJoystickButtons;
    da_glfwGetJoystickName glfwGetJoystickName;
    da_glfwSetJoystickCallback glfwSetJoystickCallback;
    da_glfwSetClipboardString glfwSetClipboardString;
    da_glfwGetClipboardString glfwGetClipboardString;
    da_glfwGetTime glfwGetTime;
    da_glfwSetTime glfwSetTime;
    da_glfwGetTimerValue glfwGetTimerValue;
    da_glfwGetTimerFrequency glfwGetTimerFrequency;
    da_glfwMakeContextCurrent glfwMakeContextCurrent;
    da_glfwGetCurrentContext glfwGetCurrentContext;
    da_glfwSwapBuffers glfwSwapBuffers;
    da_glfwSwapInterval glfwSwapInterval;
    da_glfwExtensionSupported glfwExtensionSupported;
    da_glfwGetProcAddress glfwGetProcAddress;
    da_glfwVulkanSupported glfwVulkanSupported;
}

class DerelictGLFW3Loader : SharedLibLoader {
    public this() {
        super(libNames);
    }

    public void bindMixedFunc(void** ptr, string name)
    {
        return bindFunc(ptr, name);
    }

    protected override void loadSymbols() {
        bindFunc(cast(void**)&glfwInit,"glfwInit");
        bindFunc(cast(void**)&glfwTerminate,"glfwTerminate");
        bindFunc(cast(void**)&glfwGetVersion,"glfwGetVersion");
        bindFunc(cast(void**)&glfwGetVersionString,"glfwGetVersionString");
        bindFunc(cast(void**)&glfwSetErrorCallback,"glfwSetErrorCallback");
        bindFunc(cast(void**)&glfwGetMonitors,"glfwGetMonitors");
        bindFunc(cast(void**)&glfwGetPrimaryMonitor,"glfwGetPrimaryMonitor");
        bindFunc(cast(void**)&glfwGetMonitorPos,"glfwGetMonitorPos");
        bindFunc(cast(void**)&glfwGetMonitorPhysicalSize,"glfwGetMonitorPhysicalSize");
        bindFunc(cast(void**)&glfwGetMonitorName,"glfwGetMonitorName");
        bindFunc(cast(void**)&glfwSetMonitorCallback,"glfwSetMonitorCallback");
        bindFunc(cast(void**)&glfwGetVideoModes,"glfwGetVideoModes");
        bindFunc(cast(void**)&glfwGetVideoMode,"glfwGetVideoMode");
        bindFunc(cast(void**)&glfwSetGamma,"glfwSetGamma");
        bindFunc(cast(void**)&glfwGetGammaRamp,"glfwGetGammaRamp");
        bindFunc(cast(void**)&glfwSetGammaRamp,"glfwSetGammaRamp");
        bindFunc(cast(void**)&glfwDefaultWindowHints,"glfwDefaultWindowHints");
        bindFunc(cast(void**)&glfwWindowHint,"glfwWindowHint");
        bindFunc(cast(void**)&glfwCreateWindow,"glfwCreateWindow");
        bindFunc(cast(void**)&glfwDestroyWindow,"glfwDestroyWindow");
        bindFunc(cast(void**)&glfwWindowShouldClose,"glfwWindowShouldClose");
        bindFunc(cast(void**)&glfwSetWindowShouldClose,"glfwSetWindowShouldClose");
        bindFunc(cast(void**)&glfwSetWindowTitle,"glfwSetWindowTitle");
        bindFunc(cast(void**)&glfwSetWindowIcon, "glfwSetWindowIcon");
        bindFunc(cast(void**)&glfwGetWindowPos,"glfwGetWindowPos");
        bindFunc(cast(void**)&glfwSetWindowPos,"glfwSetWindowPos");
        bindFunc(cast(void**)&glfwSetWindowSizeLimits, "glfwSetWindowSizeLimits");
        bindFunc(cast(void**)&glfwSetWindowAspectRatio, "glfwSetWindowAspectRatio");
        bindFunc(cast(void**)&glfwGetWindowSize,"glfwGetWindowSize");
        bindFunc(cast(void**)&glfwSetWindowSize,"glfwSetWindowSize");
        bindFunc(cast(void**)&glfwGetFramebufferSize,"glfwGetFramebufferSize");
        bindFunc(cast(void**)&glfwGetWindowFrameSize,"glfwGetWindowFrameSize");
        bindFunc(cast(void**)&glfwIconifyWindow,"glfwIconifyWindow");
        bindFunc(cast(void**)&glfwRestoreWindow,"glfwRestoreWindow");
        bindFunc(cast(void**)&glfwMaximizeWindow, "glfwMaximizeWindow");
        bindFunc(cast(void**)&glfwShowWindow,"glfwShowWindow");
        bindFunc(cast(void**)&glfwHideWindow,"glfwHideWindow");
        bindFunc(cast(void**)&glfwFocusWindow, "glfwFocusWindow");
        bindFunc(cast(void**)&glfwGetWindowMonitor,"glfwGetWindowMonitor");
        bindFunc(cast(void**)&glfwSetWindowMonitor, "glfwSetWindowMonitor");
        bindFunc(cast(void**)&glfwGetWindowAttrib,"glfwGetWindowAttrib");
        bindFunc(cast(void**)&glfwSetWindowUserPointer,"glfwSetWindowUserPointer");
        bindFunc(cast(void**)&glfwGetWindowUserPointer,"glfwGetWindowUserPointer");
        bindFunc(cast(void**)&glfwSetWindowPosCallback,"glfwSetWindowPosCallback");
        bindFunc(cast(void**)&glfwSetWindowSizeCallback,"glfwSetWindowSizeCallback");
        bindFunc(cast(void**)&glfwSetWindowCloseCallback,"glfwSetWindowCloseCallback");
        bindFunc(cast(void**)&glfwSetWindowRefreshCallback,"glfwSetWindowRefreshCallback");
        bindFunc(cast(void**)&glfwSetWindowFocusCallback,"glfwSetWindowFocusCallback");
        bindFunc(cast(void**)&glfwSetWindowIconifyCallback,"glfwSetWindowIconifyCallback");
        bindFunc(cast(void**)&glfwSetFramebufferSizeCallback,"glfwSetFramebufferSizeCallback");
        bindFunc(cast(void**)&glfwPollEvents,"glfwPollEvents");
        bindFunc(cast(void**)&glfwWaitEvents,"glfwWaitEvents");
        bindFunc(cast(void**)&glfwWaitEventsTimeout, "glfwWaitEventsTimeout");
        bindFunc(cast(void**)&glfwPostEmptyEvent,"glfwPostEmptyEvent");
        bindFunc(cast(void**)&glfwGetInputMode,"glfwGetInputMode");
        bindFunc(cast(void**)&glfwSetInputMode,"glfwSetInputMode");
        bindFunc(cast(void**)&glfwGetKeyName, "glfwGetKeyName");
        bindFunc(cast(void**)&glfwGetKey,"glfwGetKey");
        bindFunc(cast(void**)&glfwGetMouseButton,"glfwGetMouseButton");
        bindFunc(cast(void**)&glfwGetCursorPos,"glfwGetCursorPos");
        bindFunc(cast(void**)&glfwSetCursorPos,"glfwSetCursorPos");
        bindFunc(cast(void**)&glfwCreateCursor,"glfwCreateCursor");
        bindFunc(cast(void**)&glfwCreateStandardCursor,"glfwCreateStandardCursor");
        bindFunc(cast(void**)&glfwDestroyCursor,"glfwDestroyCursor");
        bindFunc(cast(void**)&glfwSetCursor,"glfwSetCursor");
        bindFunc(cast(void**)&glfwSetKeyCallback,"glfwSetKeyCallback");
        bindFunc(cast(void**)&glfwSetCharCallback,"glfwSetCharCallback");
        bindFunc(cast(void**)&glfwSetCharModsCallback,"glfwSetCharModsCallback");
        bindFunc(cast(void**)&glfwSetMouseButtonCallback,"glfwSetMouseButtonCallback");
        bindFunc(cast(void**)&glfwSetCursorPosCallback,"glfwSetCursorPosCallback");
        bindFunc(cast(void**)&glfwSetScrollCallback,"glfwSetScrollCallback");
        bindFunc(cast(void**)&glfwSetDropCallback,"glfwSetDropCallback");
        bindFunc(cast(void**)&glfwSetCursorEnterCallback,"glfwSetCursorEnterCallback");
        bindFunc(cast(void**)&glfwJoystickPresent,"glfwJoystickPresent");
        bindFunc(cast(void**)&glfwGetJoystickAxes,"glfwGetJoystickAxes");
        bindFunc(cast(void**)&glfwGetJoystickButtons,"glfwGetJoystickButtons");
        bindFunc(cast(void**)&glfwGetJoystickName,"glfwGetJoystickName");
        bindFunc(cast(void**)&glfwSetJoystickCallback, "glfwSetJoystickCallback");
        bindFunc(cast(void**)&glfwSetClipboardString,"glfwSetClipboardString");
        bindFunc(cast(void**)&glfwGetClipboardString,"glfwGetClipboardString");
        bindFunc(cast(void**)&glfwGetTime,"glfwGetTime");
        bindFunc(cast(void**)&glfwSetTime,"glfwSetTime");
        bindFunc(cast(void**)&glfwGetTimerValue, "glfwGetTimerValue");
        bindFunc(cast(void**)&glfwGetTimerFrequency, "glfwGetTimerFrequency");
        bindFunc(cast(void**)&glfwMakeContextCurrent,"glfwMakeContextCurrent");
        bindFunc(cast(void**)&glfwGetCurrentContext,"glfwGetCurrentContext");
        bindFunc(cast(void**)&glfwSwapBuffers,"glfwSwapBuffers");
        bindFunc(cast(void**)&glfwSwapInterval,"glfwSwapInterval");
        bindFunc(cast(void**)&glfwExtensionSupported,"glfwExtensionSupported");
        bindFunc(cast(void**)&glfwGetProcAddress,"glfwGetProcAddress");
        bindFunc(cast(void**)&glfwVulkanSupported, "glfwVulkanSupported");
    }
}

__gshared DerelictGLFW3Loader DerelictGLFW3;

shared static this() {
    DerelictGLFW3 = new DerelictGLFW3Loader();
}

// Mixins to allow loading Vulkan & OS native functions using the types
// declared in whatever Vulkan or OS binding an app is using.
mixin template DerelictGLFW3_VulkanBind() {
    extern(C) @nogc nothrow {
        alias da_glfwGetRequiredInstanceExtensions = const(char)** function(uint*);
        alias da_glfwGetInstanceProcAddress = GLFWvkproc function(VkInstance,const(char)*);
        alias da_glfwGetPhysicalDevicePresentationSupport = int function(VkInstance,VkPhysicalDevice,uint);
        alias da_glfwCreateWindowSurface = VkResult function(VkInstance,GLFWwindow*,const(VkAllocationCallbacks)*,VkSurfaceKHR*);
    }

    __gshared {
        da_glfwGetRequiredInstanceExtensions glfwGetRequiredInstanceExtensions;
        da_glfwGetInstanceProcAddress glfwGetInstanceProcAddress;
        da_glfwGetPhysicalDevicePresentationSupport glfwGetPhysicalDevicePresentationSupport;
        da_glfwCreateWindowSurface glfwCreateWindowSurface;
    }

    void DerelictGLFW3_loadVulkan() {
        assert(DerelictGLFW3.isLoaded);

        with(DerelictGLFW3) {
            bindMixedFunc(cast(void**)&glfwGetRequiredInstanceExtensions, "glfwGetRequiredInstanceExtensions");
            bindMixedFunc(cast(void**)&glfwGetInstanceProcAddress, "glfwGetInstanceProcAddress");
            bindMixedFunc(cast(void**)&glfwGetPhysicalDevicePresentationSupport, "glfwGetPhysicalDevicePresentationSupport");
            bindMixedFunc(cast(void**)&glfwCreateWindowSurface, "glfwCreateWindowSurface");
        }
    }
}

mixin template DerelictGLFW3_EGLBind() {
    extern(C) @nogc nothrow {
        alias da_glfwGetEGLDisplay = EGLDisplay function();
        alias da_glfwGetEGLContext = EGLContext function(GLFWwindow*);
        alias da_glfwGetEGLSurface = EGLSurface function(GLFWwindow*);
    }

    __gshared {
        da_glfwGetEGLDisplay glfwGetEGLDisplay;
        da_glfwGetEGLContext glfwGetEGLContext;
        da_glfwGetEGLSurface glfwGetEGLSurface;
    }

    void DerelictGLFW3_loadEGK() {
        assert(DerelictGLFW3.isLoaded);

        with(DerelictGLFW3) {
            bindMixedFunc(cast(void**)&glfwGetEGLDisplay, "glfwGetEGLDisplay");
            bindMixedFunc(cast(void**)&glfwGetEGLContext, "glfwGetEGLContext");
            bindMixedFunc(cast(void**)&glfwGetEGLSurface,"glfwGetEGLSurface");
        }
    }
}

static if(Derelict_OS_Mac) {
    mixin template DerelictGLFW3_MacBind() {
        extern(C) @nogc nothrow {
            alias da_glfwGetCocoaMonitor = CGDirectDisplayID function(GLFWmonitor*);
            alias da_glfwGetCocoaWindow = id function(GLFWwindow* window);
            alias da_glfwGetNSGLContext = id function(GLFWwindow* window);
        }

        void DerelictGLFW3_loadMac() {
            assert(DerelictGLFW3.isLoaded);

            with(DerelictGLFW3) {
                bindMixedFunc(cast(void**)&glfwGetCocoaMonitor, "glfwGetCocoaMonitor");
                bindMixedFunc(cast(void**)&glfwGetCocoaWindow,"glfwGetCocoaWindow");
                bindMixedFunc(cast(void**)&glfwGetNSGLContext,"glfwGetNSGLContext");
            }
        }
        alias DerelictGLFW3_loadNative = DerelictGLFW3_loadMac;
    }
    alias DerelictGLFW3_NativeBind = DerelictGLFW3_MacBind;
}
else static if(Derelict_OS_Windows) {
    mixin template DerelictGLFW3_WindowsBind() {
        extern(C) @nogc nothrow {
            alias da_glfwGetWin32Adapter = const(char)* function(GLFWmonitor*);
            alias da_glfwGetWin32Monitor = const(char)* function(GLFWmonitor*);
            alias da_glfwGetWin32Window = HWND function(GLFWwindow* window);
            alias da_glfwGetWGLContext = HGLRC function(GLFWwindow* window);
        }

        __gshared {
            da_glfwGetWin32Adapter glfwGetWin32Adapter;
            da_glfwGetWin32Monitor glfwGetWin32Monitor;
            da_glfwGetWin32Window glfwGetWin32Window;
            da_glfwGetWGLContext glfwGetWGLContext;
        }

        void DerelictGLFW3_loadWindows() {
            assert(DerelictGLFW3.isLoaded);

            with(DerelictGLFW3) {
                bindMixedFunc(cast(void**)&glfwGetWin32Adapter, "glfwGetWin32Adapter");
                bindMixedFunc(cast(void**)&glfwGetWin32Monitor, "glfwGetWin32Monitor");
                bindMixedFunc(cast(void**)&glfwGetWin32Window,"glfwGetWin32Window");
                bindMixedFunc(cast(void**)&glfwGetWGLContext,"glfwGetWGLContext");
            }
        }
        alias DerelictGLFW3_loadNative = DerelictGLFW3_loadWindows;
    }
    alias DerelictGLFW3_NativeBind = DerelictGLFW3_WindowsBind;
}
else static if(Derelict_OS_Posix) {
    mixin template DerelictGLFW3_X11Bind() {
        extern(C) @nogc nothrow {
            alias da_glfwGetX11Display = Display* function();
            alias da_glfwGetX11Adapter = RRCrtc function(GLFWmonitor*);
            alias da_glfwGetX11Monitor = RROutput function(GLFWmonitor*);
            alias da_glfwGetX11Window = Window function(GLFWwindow*);
            alias da_glfwGetGLXContext = GLXContext function(GLFWwindow*);
            alias da_glfwGetGLXWindow = GLXWindow function(GLFWwindow*);
        }

        __gshared {
            da_glfwGetX11Display glfwGetX11Display;
            da_glfwGetX11Adapter glfwGetX11Adapter;
            da_glfwGetX11Monitor glfwGetX11Monitor;
            da_glfwGetX11Window glfwGetX11Window;
            da_glfwGetGLXContext glfwGetGLXContext;
            da_glfwGetGLXWindow glfwGetGLXWindow;
        }

        void DerelictGLFW3_loadX11() {
            assert(DerelictGLFW3.isLoaded);

            with(DerelictGLFW3) {
                bindMixedFunc(cast(void**)&glfwGetX11Display, "glfwGetX11Display");
                bindMixedFunc(cast(void**)&glfwGetX11Adapter, "glfwGetX11Adapter");
                bindMixedFunc(cast(void**)&glfwGetX11Monitor,"glfwGetX11Monitor");
                bindMixedFunc(cast(void**)&glfwGetX11Window,"glfwGetX11Window");
                bindMixedFunc(cast(void**)&glfwGetGLXContext, "glfwGetGLXContext");
                bindMixedFunc(cast(void**)&glfwGetGLXWindow, "glfwGetGLXWindow");
            }
        }
        alias DerelictGLFW3_loadNative = DerelictGLFW3_loadX11;
    }
    alias DerelictGLFW3_NativeBind = DerelictGLFW3_X11Bind;

    mixin template DerelictGLFW3_WaylandBind() {
        extern(C) @nogc nothrow {
            alias da_glfwGetWaylandDisplay = wl_display* function();
            alias da_glfwGetWaylandMonitor = wl_output* function(GLFWmonitor*);
            alias da_glfwGetWaylandWindow = wl_surface* function(GLFWwindow*);
        }

        __gshared {
            da_glfwGetWaylandDisplay glfwGetWaylandDisplay;
            da_glfwGetWaylandMonitor glfwGetWaylandMonitor;
            da_glfwGetWaylandWindow glfwGetWaylandWindow;
        }

        void DerelictGLFW3_loadWayland() {
            assert(DerelictGLFW3.isLoaded);

            with(DerelictGLFW3) {
                bindMixedFunc(cast(void**)&glfwGetWaylandDisplay, "glfwGetWaylandDisplay");
                bindMixedFunc(cast(void**)&glfwGetWaylandMonitor, "glfwGetWaylandMonitor");
                bindMixedFunc(cast(void**)&glfwGetWaylandWindow,"glfwGetWaylandWindow");
            }
        }
    }

    mixin template DerelictGLFW3_MirBind() {
        extern(C) @nogc nothrow {
            alias da_glfwGetMirDisplay = MirConnection* function();
            alias da_glfwGetMirMonitor = int function(GLFWmonitor*);
            alias da_glfwGetMirWindow = MirSurface* function(GLFWwindow*);
        }

        __gshared {
            da_glfwGetMirDisplay glfwGetMirDisplay;
            da_glfwGetMirMonitor glfwGetMirMonitor;
            da_glfwGetMirWindow glfwGetMirWindow;
        }

        void DerelictGLFW3_loadMir() {
            assert(DerelictGLFW3.isLoaded);

            with(DerelictGLFW3) {
                bindMixedFunc(cast(void**)&glfwGetMirDisplay, "glfwGetMirDisplay");
                bindMixedFunc(cast(void**)&glfwGetMirMonitor, "glfwGetMirMonitor");
                bindMixedFunc(cast(void**)&glfwGetMirWindow,"glfwGetMirWindow");
            }
        }
    }

}

